syntax = 'proto3';

package SessionSyncModule;

service SessionSync {
  // [5]에 해당. 세션들 간 통신
  rpc SessionComm (PublishDatamap) returns (ACKMessage);

}

message Void {} // Response or Reply Message 내용이 필요 없을 때를 위한 메시지 타입 정의

// [5]에서 Publish 하는데 사용하는 메시지.
// 필수 내용: git diff 패치 파일, related 정보, 파일 경로
// Asset 단위로 보낸다.
message PublishDatamap {
  string transID = 1; // 트랜잭션 번호 {Timestamp} + {Datamap Filename} + 'SEND'
  string related = 2; // Kafka 메시지에서 받은 내용 그대로
  string filepath = 3; // /doamin/taxonomy/category/.../category/id.asset
  bytes git_patch = 4; // git_patch 파일
}

// ACK 메시지
message ACKMessage {
  string transID = 1; // 트랜잭션 번호 {Timestamp} + {Datamap Filename} + 'ACK'
  int result = 2; // 0은 Success, 1은 Failed ... 다양한 오류 값   검출 가능하게 해 보기
}